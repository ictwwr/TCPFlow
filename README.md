# TCPFlow
INTRODUCTION TO TCPFLOW
TCPFlow is a software tool that analyzes offline and online packet traffic for the statistics of 5-tuple TCP flows. It has two versions written with C in Linux: TCPFlow-Offline and TCPFlow-Online.
1.TCPFlow-Offline
TCPFlow-Offline processes a traffic file in pcap format generated by WireShark and TCPDump. It outputs the statistics of TCP flows to a text file in the following format:
<local_time>, <time_stamp>, <src_ip>, <src_port>, <dst_ip>, <dst_port>, <tcp/udp>
In addition, it also outputs the ranking statistics of TCP flows including the Top 10 TCP flows in packets and in bytes, Top 10 source IP addresses, and Top 10 destination IP addresses.
TCPFlow_Offline runs with the following parameters:
tcpflow-offline [-r <input_pcap_file>] [-w <output_flow_file>] [-s <output_stat_file>]
2.TCPFlow-Online
TCPFlow-Online captures online packet TCP flows with a promiscuous mode in a network device. It outputs 5-tuples of each TCP flow to a text file in the following format:
<local_time>, <time_stamp>, <src_ip>, <src_port>, <dst_ip>, <dst_port>, <tcp/udp>
TCPFlow-Online runs with the following parameters:
tcpflow-online [-i <netdevice_num>] [-c <packet_count>][-w <output_flow_file>] [-s <output_stat_file>]
PREPARATION
To run TCPFlow, please make sure of installing the libpcap libraries with the root permission.
HOW TO USE IT
You can compile and run TCPFlow in Linux as follows:
1.TCPFlow-Offline
(1)Compile TCPFlow-Offline:
gcc -o tcpflow-offline tcpflow_offline.c
(2)Run TCPFlow-Offline
./tcpflow-offline -r test.pcap -w output_tcpflow.txt -s output_summary.txt
2.TCPFlow-Online
(1)Compile TCPFlow-Online:
gcc -o tcpflow_online tcpflow_online.c -lpcap 
(2)Run TCPFlow-Online
./tcpflow_online -i eth0 -c 2000 -w output_tcpflow.txt -s output_summary.txt 
